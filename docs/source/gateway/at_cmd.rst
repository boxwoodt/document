AT 指令
==========================

介绍网关开发板所支持的 AT 指令，方便客户进行网关测试及使用。

AT 指令格式
+++++++++++++++++++++++++++++++++++++

.. csv-table::
    :header: "AT 指令格式", "描述", "示例"
    :widths: 40 60 60

    "AT+<命令>", "运行指令", "AT+RST"
    "AT+<命令>?", "查询参数值", "AT+VER?"
    "AT+<命令>=<参数>,<参数>,...", "设置参数值", "AT+DHCP=1"

AT 指令返回值
+++++++++++++++++++++++++++++++++++++

.. csv-table::
    :header: "返回值", "描述"
    :widths: 40 60

    "AT_OK", "执行成功"
    "AT_ERROR", "执行失败"
    "AT_PARAM_ERROR", "参数错误"
    "AT_CMD_ERROR", "指令错误"

AT 指令列表
++++++++++++++++++++++++++++++++++++++

+----------------+-------------------------+-----------------------------+
|      分类      |          指令           |            说明             |
+================+=========================+=============================+
| 基础指令       | AT                      | AT链路检查                  |
+                +-------------------------+-----------------------------+
|                | AT+RST                  | 复位MCU                     |
+                +-------------------------+-----------------------------+
|                | AT+VER                  | 查询固件版本号              |
+                +-------------------------+-----------------------------+
|                | AT+GWMAC                | 查询网关MAC                 |
+----------------+-------------------------+-----------------------------+
| 网络指令       | AT+NETMODE              | 设置/查询联网方式           |
+                +-------------------------+-----------------------------+
|                | AT+DHCP                 | 设置/查询DHCP配置           |
+                +-------------------------+-----------------------------+
|                | AT+GWIP                 | 设置/查询以太网IP地址       |
+                +-------------------------+-----------------------------+
|                | AT+GW                   | 设置/查询以太网网关地址     |
+                +-------------------------+-----------------------------+
|                | AT+DNS                  | 设置/查询DNS地址            |
+                +-------------------------+-----------------------------+
|                | AT+MASK                 | 设置/查询以太网子网掩码     |
+                +-------------------------+-----------------------------+
|                | AT+IFCONFIG             | 查询网络接口                |
+                +-------------------------+-----------------------------+
|                | AT+PING                 | Ping测试                    |
+----------------+-------------------------+-----------------------------+
| 无线配置指令   | AT+TURFREQ              | 无线模块频点配置            |
+                +-------------------------+-----------------------------+
|                | AT+TURFREQQUERY         | 无线模块频点查询            |
+----------------+-------------------------+-----------------------------+
| 服务器配置指令 | AT+SERVER               | 设置/查询服务器地址和端口号 |
+                +-------------------------+-----------------------------+
|                | AT+MQTTUSR              | 设置/查询MQTT账号和密码     |
+----------------+-------------------------+-----------------------------+
| 升级指令       | AT+MCUOTA               | 升级MCU固件                 |
+                +-------------------------+-----------------------------+
|                | AT+TUROTA               | 升级无线模块固件            |
+----------------+-------------------------+-----------------------------+

AT 指令说明
++++++++++++++++++++++++++++++++++++++

**AT**
-----------------------------------------------

- 描述：

  测试串口是否连接正常

- 示例：

.. code-block::

    AT
    AT_OK

**AT+RST**
-----------------------------------------------

- 描述：

  重启设备
 
- 示例：

 .. code-block::
    
    AT+RST
    AT_OK

**AT+VER**
-----------------------------------------------

- 描述：

  获取设备版本信息

- 示例：

 .. code-block::
    
    AT+VER?
    +GW_VER:2.0.11 Sep  4 2024 18:47:10
    +TUR1_VER:2.0.9
    +TUR2_VER:2.0.9
    AT_OK

**AT+GWMAC**
-----------------------------------------------

- 描述：

  获取网关MAC信息

- 示例：

 .. code-block::
    
    AT+GWMAC?
    +GWMAC:08:34:09:32:3A:62
    +GWID:00390038-3430510C-33363230
    AT_OK

**AT+NETMODE**
-----------------------------------------------

- 描述：

  设置/查询联网方式

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+NETMODE=<联网方式> | AT_OK                |
+-----------------------+----------------------+
| AT+NETMODE?           | <联网方式> AT_OK     |
+-----------------------+----------------------+

- 参数说明：

+------------+-------+------------+
|    参数    |   值  |    描述    |
+============+=======+============+
| <联网方式> |   ETH | 以太网模式 |
+            +-------+------------+
|            |   4G  | 4G模式     |
+------------+-------+------------+

- 示例：

 .. code-block::
    
    AT+NETMODE=ETH
    AT_OK

    AT+NETMODE?
    +NETMODE:ETH
    AT_OK

**AT+DHCP**
-----------------------------------------------

- 描述：

  设置/查询DHCP配置

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+DHCP=<DHCP开关>    | AT_OK                |
+-----------------------+----------------------+
| AT+DHCP?              | <DHCP开关> AT_OK     |
+-----------------------+----------------------+

- 参数说明：

+---------------+-------+----------+
|     参数      |   值  |   描述   |
+===============+=======+==========+
| <DHCP开关>    |   0   | 关闭DHCP |
+               +-------+----------+
|               |   1   | 开启DHCP |
+---------------+-------+----------+

- 示例：

 .. code-block::
    
    AT+DHCP=1
    AT_OK

    AT+DHCP?
    +DHCP:1
    AT_OK

**AT+GWIP**
-----------------------------------------------

- 描述：

  设置/查询以太网IP地址

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+GWIP=<IP地址>      | AT_OK                |
+-----------------------+----------------------+
| AT+GWIP?              | <IP地址> AT_OK       |
+-----------------------+----------------------+

- 参数说明：

+----------+----------+
|   参数   |   描述   |
+==========+==========+
| <IP地址> | 以太网IP |
+----------+----------+

- 示例：

.. code-block::

    AT+GWIP=192.168.1.3
    AT_OK

    AT+GWIP?
    +GWIP:192.168.1.3
    AT_OK

**AT+GW**
-----------------------------------------------

- 描述：

  设置/查询以太网网关地址

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+GW=<网关地址>      | AT_OK                |
+-----------------------+----------------------+
| AT+GW?                | <网关地址> AT_OK     |
+-----------------------+----------------------+

- 参数说明：

+------------+----------------+
|    参数    |      描述      |
+============+================+
| <网关地址> | 以太网网关地址 |
+------------+----------------+

- 示例：

.. code-block::
    
    AT+GW=192.168.1.1
    AT_OK

    AT+GW?
    +GW:192.168.1.1
    AT_OK

**AT+MASK**
-----------------------------------------------

- 描述：

  设置/查询子网掩码

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+MASK=<子网掩码>    | AT_OK                |
+-----------------------+----------------------+
| AT+MASK?              | <子网掩码> AT_OK     |
+-----------------------+----------------------+

- 参数说明：

+------------+----------------+
|    参数    |      描述      |
+============+================+
| <子网掩码> | 以太网子网掩码 |
+------------+----------------+

- 示例：

.. code-block::

    AT+MASK=255.255.255.0
    AT_OK

    AT+MASK?
    +MASK:255.255.255.0
    AT_OK

**AT+DNS**
-----------------------------------------------

- 描述：

  设置/查询DNS地址

+---------------------------------+------------------------------+
|         指令                    |         响应                 |
+=================================+==============================+
| AT+DNS=<DNS1地址>,<DNS2地址>    | AT_OK                        |
+---------------------------------+------------------------------+
| AT+DNS?                         | <DNS1地址> <DNS2地址> AT_OK  |
+---------------------------------+------------------------------+

- 参数说明：

+------------------+----------+
|      参数        |   描述   |
+==================+==========+
| <DNS1地址>       | DNS1地址 |
+------------------+----------+
| <DNS2地址>       | DNS2地址 |
+------------------+----------+

- 示例：

.. code-block::

    AT+DNS=114.114.114.114,8.8.8.8
    AT_OK

    AT+DNS?
    +DNS:114.114.114.114 8.8.8.8
    AT_OK

**AT+IFCONFIG**
-----------------------------------------------

- 描述：

  查询网络接口

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+IFCONFIG           | <接口信息> AT_OK     |
+-----------------------+----------------------+

- 示例：

.. code-block::

    AT+IFCONFIG
    +NET DEVICE: e0 (Default)
    +MTU: 1500
    +MAC: 00 80 e1 07 3d 32 
    +FLAGS: UP LINK_UP INTERNET_UP DHCP_ENABLE ETHARP BROADCAST IGMP
    +IP ADDR: 192.168.2.153
    +GW ADDR: 192.168.2.1
    +NET MASK: 255.255.255.0
    +DNS1 SERVER: 192.168.2.1
    +DNS2 SERVER: 8.8.8.8
    AT_OK

**AT+PING**
-----------------------------------------------

- 描述：

  ping测试

+-----------------------+----------------------+
|         指令          |         响应         |
+=======================+======================+
| AT+PING=<域名/IP地址> | AT_OK                |
+-----------------------+----------------------+

- 参数说明：

+---------------+-------------+
|     参数      |    描述     |
+===============+=============+
| <域名/IP地址> | 域名/IP地址 |
+---------------+-------------+

- 示例：

.. code-block::

    AT+PING="www.baidu.com"
    60 bytes from 14.215.177.39 icmp_seq=0 ttl=55 time=41 ms
    60 bytes from 14.215.177.39 icmp_seq=1 ttl=55 time=24 ms
    60 bytes from 14.215.177.39 icmp_seq=2 ttl=55 time=24 ms
    60 bytes from 14.215.177.39 icmp_seq=3 ttl=55 time=24 ms
    AT_OK

**AT+TURFREQ**
-----------------------------------------------

- 描述：

  设置无线模块工作频率

+----------------------------------------+--------------+
|                  指令                  |     响应     |
+========================================+==============+
| AT+TURFREQ=<通道>,<数据频点>,<BCN频点> | AT_OK        |
+----------------------------------------+--------------+

- 参数说明：

+------------+---------------------+
|    参数    |        描述         |
+============+=====================+
| <通道>     | 通道号，取值范围1~2 |
+------------+---------------------+
| <数据频点> | 数据频点，单位：Hz  |
+------------+---------------------+
| <BCN频点>  | BCN频点，单位：Hz   |
+------------+---------------------+

- 示例：

.. code-block::

    AT+TURFREQ=1,474300000,473200000
    AT_OK

**AT+TURFREQQUERY**
----------------------------------------------

- 描述：

  查询无线模块工作频率

+------------------------+----------------------------+
|          指令          |            响应            |
+========================+============================+
| AT+TURFREQQUERY=<通道> | <数据频点> <BCN频点> AT_OK |
+------------------------+----------------------------+

- 参数说明：

+------------+---------------------+
|    参数    |        描述         |
+============+=====================+
| <通道>     | 通道号，取值范围1~2 |
+------------+---------------------+

- 示例：

.. code-block::

    AT+TURFREQQUERY=1
    +CHAN:1
    +BCN_FREQ:473200000
    +DATA_FREQ:474300000
    AT_OK

**AT+SERVER**
-----------------------------------------------
- 描述：

  设置/查询服务器地址

+---------------------------------+----------------------------+
|              指令               |            响应            |
+=================================+============================+
| AT+SERVER=<服务器地址>,<端口号> | AT_OK                      |
+---------------------------------+----------------------------+
| AT+SERVER?                      | <服务器地址> <端口号>AT_OK |
+---------------------------------+----------------------------+

- 参数说明：

+--------------+------------+
|     参数     |    描述    |
+==============+============+
| <服务器地址> | 服务器地址 |
+--------------+------------+
| <端口号>     | 端口号     |
+--------------+------------+

- 示例：

.. code-block::

    AT+SERVER=amqtt.taolink-tech.com,1883
    AT_OK

    AT+SERVER?
    +SEVIP:amqtt.taolink-tech.com
    +SEVPORT:1883
    AT_OK

**AT+MQTTUSR**
-----------------------------------------------

- 描述：

  设置/查询用户名和密码

+----------------------------+----------------------+
|            指令            |         响应         |
+============================+======================+
| AT+MQTTUSR=<用户名>,<密码> | AT_OK                |
+----------------------------+----------------------+
| AT+MQTTUSR?                | <用户名> <密码>AT_OK |
+----------------------------+----------------------+

- 参数说明：

+----------+--------+
|   参数   |  描述  |
+==========+========+
| <用户名> | 用户名 |
+----------+--------+
| <密码>   | 密码   |
+----------+--------+

- 示例：

.. code-block::

    AT+MQTTUSR=taolink,taolink-tech
    AT_OK

    AT+MQTTUSR?
    +MQTTUSR:taolink
    +MQTTPWD:taolink-tech
    AT_OK

**AT+MCUOTA**
-----------------------------------------------

- 描述：

  升级MCU固件

+----------------------+-------+
|         指令         | 响应  |
+======================+=======+
| AT+MCUOTA=<升级地址> | AT_OK |
+----------------------+-------+

- 参数说明：

+------------+--------------------+
|    参数    |        描述        |
+============+====================+
| <升级地址> | 升级文件地址       |
+------------+--------------------+

.. note:: 升级文件后缀为 .rbl。升级地址使用双引号（""）包含。

- 示例：

.. code-block::

    AT+MCUOTA="http://download.taolink-tech.com:11180/TKB-320_FW_V1.5.8.rbl"
    AT_OK

**AT+TUROTA**
-----------------------------------------------

- 描述：

  升级TurMass模块固件

+--------------------------------------------+-------+
|                    指令                    | 响应  |
+============================================+=======+
| AT+TUROTA=<模块选择>,<清空参数>,<升级地址> | AT_OK |
+--------------------------------------------+-------+

- 参数说明：

+------------------+--------+---------------------+ 
|       参数       |  值    |        描述         |
+==================+========+=====================+
| <模块选择>       | 1      | 无线模块1升级       |
+                  +--------+---------------------+
|                  | 2      | 无线模块2升级       |
+------------------+--------+---------------------+
| <清空参数开关>   | 0      | 保留参数            |
+                  +--------+---------------------+
|                  | 1      | 清空参数            |
+------------------+--------+---------------------+
| <升级地址>       | 地址   | 升级文件地址        |
+------------------+--------+---------------------+

.. note:: 无线模块升级文件后缀为 .bin。升级地址使用双引号（""）包含。 

- 示例：

.. code-block::

    AT+TUROTA=1,0,"http://download.taolink-tech.com:11180/TK8620_SLIP_V2.0.7.bin"
    AT_OK
